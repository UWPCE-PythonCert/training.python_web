<!--
Google IO 2012/2013 HTML5 Slide Template

Authors: Eric Bidelman <ebidel@gmail.com>
         Luke Mah√© <lukem@google.com>

URL: https://code.google.com/p/io-2012-slides
--><!DOCTYPE html>


<html>
<head>
  <title>Session 02 &mdash; Internet Programming with Python</title>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <!--This one seems to work all the time, but really small on ipad-->
  <!--<meta name="viewport" content="initial-scale=0.4">-->
  <meta name="apple-mobile-web-app-capable" content="yes">

  
  <link rel="stylesheet" media="all"
        href="../_static/theme/css/default.css">
  <link rel="stylesheet" media="all"
        href="../_static/theme/css/hieroglyph.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)"
        href="../_static/theme/css/phone.css">

    
    <link rel="stylesheet" href="../_static/custom.css"
          type="text/css" />
    

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <script data-main="../_static/js/slides"
            src="../_static/js/require-1.0.8.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="Internet Programming with Python" href="../index.html" />
    <link rel="up" title="Course Presentations" href="index.html" />
    <link rel="next" title="Session 03" href="session03.html" />
    <link rel="prev" title="Session 01" href="session01.html" /> 
</head>
<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
  <aside class="gdbar"><img src="../_static/logo_UW.png"></aside>
  <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
  <hgroup class="auto-fadein">
    <h1 data-config-title><!-- populated from slide_config.json --></h1>
    <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
    <p data-config-presenter><!-- populated from slide_config.json --></p>
  </hgroup>
</slide>

  
    <slide class="title-slide segue nobackground level-1" id="session-02">
    <hgroup>
      <h1>Session 02</h1>
    </hgroup>
    <article class="">
      <div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../_images/protocol.png"><img alt="../_images/protocol.png" src="../_images/protocol.png" style="width: 40%;" /></a>
<p class="caption"><span class="caption-text">Web Protocols</span></p>
</div>



<div class="slide-no">1</div>


    </article>
  </slide>  <slide class="level-2" id="the-languages-computers-speak">
    <hgroup>
      <h2>The Languages Computers Speak</h2>
    </hgroup>
    <article class="">
      <div class="build left docutils container">
<p>Programming languages like Python are the languages we speak to computers.</p>
<p><em>Protocols</em> are the languages that computers speak to each-other.</p>
<p>This sesson we'll look at a few of them and</p>
<ul class="build simple">
<li>Learn what makes them similar</li>
<li>Learn what makes them different</li>
<li>Learn about Python's tools for speaking them</li>
<li>Learn how to speak one (HTTP) ourselves</li>
</ul>
</div>



<div class="slide-no">2</div>


    </article>
  </slide>  <slide class="level-3" id="but-first">
    <hgroup>
      <h3>But First</h3>
    </hgroup>
    <article class="">
      <p class="large centered">Questions from the Homework?</p>



<div class="slide-no">3</div>


    </article>
  </slide>  <slide class="level-3" id="id4">
    <hgroup>
      <h3>But First</h3>
    </hgroup>
    <article class="">
      <p class="large centered">Examples of an echo server using <code class="docutils literal"><span class="pre">select</span></code></p>



<div class="slide-no">4</div>


    </article>
  </slide>  <slide class="level-3" id="what-is-a-protocol">
    <hgroup>
      <h3>What is a Protocol?</h3>
    </hgroup>
    <article class="">
      <div class="build large centered docutils container">
<p><strong>a set of rules or conventions</strong></p>
<p><strong>governing communications</strong></p>
</div>



<div class="slide-no">5</div>


    </article>
  </slide>  <slide class="level-3" id="id5">
    <hgroup>
      <h3>Protocols IRL</h3>
    </hgroup>
    <article class="">
      <p>Life has lots of sets of rules for how to do things.</p>
<ul class="build simple">
<li>What do you say when you get on the elevator?</li>
<li>What do you do on a first date?</li>
<li>What do you wear to a job interview?</li>
<li>What do (and don't) you talk about at a dinner party?</li>
<li>...?</li>
</ul>



<div class="slide-no">6</div>


    </article>
  </slide>  <slide class="level-3" id="id6">
    <hgroup>
      <h3>Protocols IRL</h3>
    </hgroup>
    <article class="">
      <div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../_images/icup.png"><img alt="../_images/icup.png" src="../_images/icup.png" style="width: 65%;" /></a>
<p class="caption"><span class="caption-text"><a class="reference external" href="http://blog.xkcd.com/2009/09/02/urinal-protocol-vulnerability/">http://blog.xkcd.com/2009/09/02/urinal-protocol-vulnerability/</a></span></p>
</div>



<div class="slide-no">7</div>


    </article>
  </slide>  <slide class="level-3" id="id7">
    <hgroup>
      <h3>Protocols In Computers</h3>
    </hgroup>
    <article class="">
      <p>Digital life has lots of rules too:</p>
<ul class="build simple">
<li>how to say hello</li>
<li>how to identify yourself</li>
<li>how to ask for information</li>
<li>how to provide answers</li>
<li>how to say goodbye</li>
</ul>



<div class="slide-no">8</div>


    </article>
  </slide>  <slide class="level-3" id="real-protocol-examples">
    <hgroup>
      <h3>Real Protocol Examples</h3>
    </hgroup>
    <article class="">
      <p>What does this look like in practice?</p>
<ul class="build simple">
<li>SMTP (Simple Message Transfer Protocol) <br />
<a class="reference external" href="http://tools.ietf.org/html/rfc5321#appendix-D">http://tools.ietf.org/html/rfc5321#appendix-D</a></li>
<li>POP3 (Post Office Protocol) <br />
<a class="reference external" href="http://www.faqs.org/docs/artu/ch05s03.html">http://www.faqs.org/docs/artu/ch05s03.html</a></li>
<li>IMAP (Internet Message Access Protocol) <br />
<a class="reference external" href="http://www.faqs.org/docs/artu/ch05s03.html">http://www.faqs.org/docs/artu/ch05s03.html</a></li>
<li>HTTP (Hyper-Text Transfer Protocol) <br />
<a class="reference external" href="http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol</a></li>
</ul>



<div class="slide-no">9</div>


    </article>
  </slide>  <slide class="level-3" id="id8">
    <hgroup>
      <h3>A Word on Typography</h3>
    </hgroup>
    <article class="">
      <p>Over the next few slides we'll be looking at server/client interactions.</p>
<div class="build docutils container">
<p>Each interaction is line-based, each line represents one message.</p>
<p>Messages from the Server to the Client are prefaced with <code class="docutils literal"><span class="pre">S</span> <span class="pre">(&lt;--)</span></code></p>
<p>Messages from the Client to the Server are prefaced with <code class="docutils literal"><span class="pre">C</span> <span class="pre">(--&gt;)</span></code></p>
<p><strong>All</strong> lines end with the character sequence <code class="docutils literal"><span class="pre">&lt;CRLF&gt;</span></code> (<code class="docutils literal"><span class="pre">\r\n</span></code>)</p>
</div>



<div class="slide-no">10</div>


    </article>
  </slide>  <slide class="level-3" id="smtp">
    <hgroup>
      <h3>SMTP</h3>
    </hgroup>
    <article class="">
      <p>What does SMTP look like?</p>
<div class="build docutils container">
<p>SMTP (Say hello and identify yourself):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">220</span> <span class="n">foo</span><span class="o">.</span><span class="n">com</span> <span class="n">Simple</span> <span class="n">Mail</span> <span class="n">Transfer</span> <span class="n">Service</span> <span class="n">Ready</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">EHLO</span> <span class="n">bar</span><span class="o">.</span><span class="n">com</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">250</span><span class="o">-</span><span class="n">foo</span><span class="o">.</span><span class="n">com</span> <span class="n">greets</span> <span class="n">bar</span><span class="o">.</span><span class="n">com</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">250</span><span class="o">-</span><span class="mi">8</span><span class="n">BITMIME</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">250</span><span class="o">-</span><span class="n">SIZE</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">250</span><span class="o">-</span><span class="n">DSN</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">250</span> <span class="n">HELP</span>
</pre></div>
</div>
</div>



<div class="slide-no">11</div>


    </article>
  </slide>  <slide class="level-3" id="id9">
    <hgroup>
      <h3>SMTP</h3>
    </hgroup>
    <article class="">
      <p>What does SMTP look like?</p>
<p>SMTP (Ask for information, provide answers):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">MAIL</span> <span class="n">FROM</span><span class="p">:</span><span class="o">&lt;</span><span class="n">Smith</span><span class="nd">@bar</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">250</span> <span class="n">OK</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">RCPT</span> <span class="n">TO</span><span class="p">:</span><span class="o">&lt;</span><span class="n">Jones</span><span class="nd">@foo</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">250</span> <span class="n">OK</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">RCPT</span> <span class="n">TO</span><span class="p">:</span><span class="o">&lt;</span><span class="n">Green</span><span class="nd">@foo</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">550</span> <span class="n">No</span> <span class="n">such</span> <span class="n">user</span> <span class="n">here</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">DATA</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">354</span> <span class="n">Start</span> <span class="n">mail</span> <span class="nb">input</span><span class="p">;</span> <span class="n">end</span> <span class="k">with</span> <span class="o">&lt;</span><span class="n">CRLF</span><span class="o">&gt;.&lt;</span><span class="n">CRLF</span><span class="o">&gt;</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">Blah</span> <span class="n">blah</span> <span class="n">blah</span><span class="o">...</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="o">...</span><span class="n">etc</span><span class="o">.</span> <span class="n">etc</span><span class="o">.</span> <span class="n">etc</span><span class="o">.</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="o">.</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">250</span> <span class="n">OK</span>
</pre></div>
</div>



<div class="slide-no">12</div>


    </article>
  </slide>  <slide class="level-3" id="id10">
    <hgroup>
      <h3>SMTP</h3>
    </hgroup>
    <article class="">
      <p>What does SMTP look like?</p>
<p>SMTP (Say goodbye):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">QUIT</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">221</span> <span class="n">foo</span><span class="o">.</span><span class="n">com</span> <span class="n">Service</span> <span class="n">closing</span> <span class="n">transmission</span> <span class="n">channel</span>
</pre></div>
</div>



<div class="slide-no">13</div>


    </article>
  </slide>  <slide class="level-3" id="id11">
    <hgroup>
      <h3>SMTP Characteristics</h3>
    </hgroup>
    <article class="">
      <ul class="build simple">
<li>Interaction consists of commands and replies</li>
<li>Each command or reply is <em>one line</em> terminated by &lt;CRLF&gt; <br />
(there are exceptions, see the <code class="docutils literal"><span class="pre">250</span></code> reply to <code class="docutils literal"><span class="pre">EHLO</span></code> above)</li>
<li>The exception is message payload, terminated by &lt;CRLF&gt;.&lt;CRLF&gt;</li>
<li>Each command has a <em>verb</em> and one or more <em>arguments</em></li>
<li>Each reply has a formal <em>code</em> and an informal <em>explanation</em></li>
</ul>



<div class="slide-no">14</div>


    </article>
  </slide>  <slide class="level-3" id="pop3">
    <hgroup>
      <h3>POP3</h3>
    </hgroup>
    <article class="">
      <p>What does POP3 look like?</p>
<div class="build docutils container">
<p>POP3 (Say hello and identify yourself):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">client</span> <span class="n">connects</span> <span class="n">to</span> <span class="n">service</span> <span class="n">port</span> <span class="mi">110</span><span class="o">&gt;</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">+</span><span class="n">OK</span> <span class="n">POP3</span> <span class="n">server</span> <span class="n">ready</span> <span class="o">&lt;</span><span class="mf">1896.6971</span><span class="nd">@mailgate</span><span class="o">.</span><span class="n">dobbs</span><span class="o">.</span><span class="n">org</span><span class="o">&gt;</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">USER</span> <span class="n">bob</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">+</span><span class="n">OK</span> <span class="n">bob</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">PASS</span> <span class="n">redqueen</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">+</span><span class="n">OK</span> <span class="n">bob</span><span class="s1">&#39;s maildrop has 2 messages (320 octets)</span>
</pre></div>
</div>
</div>



<div class="slide-no">15</div>


    </article>
  </slide>  <slide class="level-3" id="id12">
    <hgroup>
      <h3>POP3</h3>
    </hgroup>
    <article class="">
      <p>What does POP3 look like?</p>
<p>POP3 (Ask for information, provide answers):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">STAT</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">+</span><span class="n">OK</span> <span class="mi">2</span> <span class="mi">320</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">LIST</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">+</span><span class="n">OK</span> <span class="mi">1</span> <span class="n">messages</span> <span class="p">(</span><span class="mi">120</span> <span class="n">octets</span><span class="p">)</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="mi">1</span> <span class="mi">120</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">.</span>
</pre></div>
</div>



<div class="slide-no">16</div>


    </article>
  </slide>  <slide class="level-3" id="id13">
    <hgroup>
      <h3>POP3</h3>
    </hgroup>
    <article class="">
      <p>What does POP3 look like?</p>
<p>POP3 (Ask for information, provide answers):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">RETR</span> <span class="mi">1</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">+</span><span class="n">OK</span> <span class="mi">120</span> <span class="n">octets</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">server</span> <span class="n">sends</span> <span class="n">the</span> <span class="n">text</span> <span class="n">of</span> <span class="n">message</span> <span class="mi">1</span><span class="o">&gt;</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">.</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">DELE</span> <span class="mi">1</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">+</span><span class="n">OK</span> <span class="n">message</span> <span class="mi">1</span> <span class="n">deleted</span>
</pre></div>
</div>



<div class="slide-no">17</div>


    </article>
  </slide>  <slide class="level-3" id="id14">
    <hgroup>
      <h3>POP3</h3>
    </hgroup>
    <article class="">
      <p>What does POP3 look like?</p>
<p>POP3 (Say goodbye):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">QUIT</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">+</span><span class="n">OK</span> <span class="n">dewey</span> <span class="n">POP3</span> <span class="n">server</span> <span class="n">signing</span> <span class="n">off</span> <span class="p">(</span><span class="n">maildrop</span> <span class="n">empty</span><span class="p">)</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">client</span> <span class="n">hangs</span> <span class="n">up</span><span class="o">&gt;</span>
</pre></div>
</div>



<div class="slide-no">18</div>


    </article>
  </slide>  <slide class="level-3" id="id15">
    <hgroup>
      <h3>POP3 Characteristics</h3>
    </hgroup>
    <article class="">
      <div class="build docutils container">
<ul class="build simple">
<li>Interaction consists of commands and replies</li>
<li>Each command or reply is <em>one line</em> terminated by &lt;CRLF&gt;</li>
<li>The exception is message payload, terminated by &lt;CRLF&gt;.&lt;CRLF&gt;</li>
<li>Each command has a <em>verb</em> and one or more <em>arguments</em></li>
<li>Each reply has a formal <em>code</em> and an informal <em>explanation</em></li>
</ul>
<p>The codes don't really look the same, though, do they?</p>
</div>



<div class="slide-no">19</div>


    </article>
  </slide>  <slide class="level-3" id="id16">
    <hgroup>
      <h3>One Other Difference</h3>
    </hgroup>
    <article class="">
      <p>The exception to the one-line-per-message rule is <em>payload</em></p>
<div class="build docutils container">
<p>In both SMTP and POP3 this is terminated by &lt;CRLF&gt;.&lt;CRLF&gt;</p>
<p>In SMTP, the <em>client</em> has this ability</p>
<p>But in POP3, it belongs to the <em>server</em>.</p>
<p class="large centered">Why?</p>
</div>



<div class="slide-no">20</div>


    </article>
  </slide>  <slide class="level-3" id="imap">
    <hgroup>
      <h3>IMAP</h3>
    </hgroup>
    <article class="">
      <p>What does IMAP look like?</p>
<div class="build docutils container">
<p>IMAP (Say hello and identify yourself):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">client</span> <span class="n">connects</span> <span class="n">to</span> <span class="n">service</span> <span class="n">port</span> <span class="mi">143</span><span class="o">&gt;</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="n">OK</span> <span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="n">IMAP4rev1</span> <span class="n">v12</span><span class="o">.</span><span class="mi">264</span> <span class="n">server</span> <span class="n">ready</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">A0001</span> <span class="n">USER</span> <span class="s2">&quot;frobozz&quot;</span> <span class="s2">&quot;xyzzy&quot;</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="n">OK</span> <span class="n">User</span> <span class="n">frobozz</span> <span class="n">authenticated</span>
</pre></div>
</div>
</div>



<div class="slide-no">21</div>


    </article>
  </slide>  <slide class="level-3" id="id17">
    <hgroup>
      <h3>IMAP</h3>
    </hgroup>
    <article class="">
      <p>What does IMAP look like?</p>
<p>IMAP (Ask for information, provide answers [connect to an inbox]):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">A0002</span> <span class="n">SELECT</span> <span class="n">INBOX</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="mi">1</span> <span class="n">EXISTS</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="mi">1</span> <span class="n">RECENT</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="n">FLAGS</span> <span class="p">(</span>\<span class="n">Answered</span> \<span class="n">Flagged</span> \<span class="n">Deleted</span> \<span class="n">Draft</span> \<span class="n">Seen</span><span class="p">)</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="n">OK</span> <span class="p">[</span><span class="n">UNSEEN</span> <span class="mi">1</span><span class="p">]</span> <span class="n">first</span> <span class="n">unseen</span> <span class="n">message</span> <span class="ow">in</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">mail</span><span class="o">/</span><span class="n">esr</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="n">A0002</span> <span class="n">OK</span> <span class="p">[</span><span class="n">READ</span><span class="o">-</span><span class="n">WRITE</span><span class="p">]</span> <span class="n">SELECT</span> <span class="n">completed</span>
</pre></div>
</div>



<div class="slide-no">22</div>


    </article>
  </slide>  <slide class="level-3" id="id18">
    <hgroup>
      <h3>IMAP</h3>
    </hgroup>
    <article class="">
      <p>What does IMAP look like?</p>
<p>IMAP (Ask for information, provide answers [Get message sizes]):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">A0003</span> <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">RFC822</span><span class="o">.</span><span class="n">SIZE</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="mi">1</span> <span class="n">FETCH</span> <span class="p">(</span><span class="n">RFC822</span><span class="o">.</span><span class="n">SIZE</span> <span class="mi">2545</span><span class="p">)</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="n">A0003</span> <span class="n">OK</span> <span class="n">FETCH</span> <span class="n">completed</span>
</pre></div>
</div>



<div class="slide-no">23</div>


    </article>
  </slide>  <slide class="level-3" id="id19">
    <hgroup>
      <h3>IMAP</h3>
    </hgroup>
    <article class="">
      <p>What does IMAP look like?</p>
<p>IMAP (Ask for information, provide answers [Get first message header]):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">A0004</span> <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">BODY</span><span class="p">[</span><span class="n">HEADER</span><span class="p">]</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="mi">1</span> <span class="n">FETCH</span> <span class="p">(</span><span class="n">RFC822</span><span class="o">.</span><span class="n">HEADER</span> <span class="p">{</span><span class="mi">1425</span><span class="p">}</span>
<span class="o">&lt;</span><span class="n">server</span> <span class="n">sends</span> <span class="mi">1425</span> <span class="n">octets</span> <span class="n">of</span> <span class="n">message</span> <span class="n">payload</span><span class="o">&gt;</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="p">)</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="n">A0004</span> <span class="n">OK</span> <span class="n">FETCH</span> <span class="n">completed</span>
</pre></div>
</div>



<div class="slide-no">24</div>


    </article>
  </slide>  <slide class="level-3" id="id20">
    <hgroup>
      <h3>IMAP</h3>
    </hgroup>
    <article class="">
      <p>What does IMAP look like?</p>
<p>IMAP (Ask for information, provide answers [Get first message body]):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">A0005</span> <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">BODY</span><span class="p">[</span><span class="n">TEXT</span><span class="p">]</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="mi">1</span> <span class="n">FETCH</span> <span class="p">(</span><span class="n">BODY</span><span class="p">[</span><span class="n">TEXT</span><span class="p">]</span> <span class="p">{</span><span class="mi">1120</span><span class="p">}</span>
<span class="o">&lt;</span><span class="n">server</span> <span class="n">sends</span> <span class="mi">1120</span> <span class="n">octets</span> <span class="n">of</span> <span class="n">message</span> <span class="n">payload</span><span class="o">&gt;</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="p">)</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="mi">1</span> <span class="n">FETCH</span> <span class="p">(</span><span class="n">FLAGS</span> <span class="p">(</span>\<span class="n">Recent</span> \<span class="n">Seen</span><span class="p">))</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="n">A0005</span> <span class="n">OK</span> <span class="n">FETCH</span> <span class="n">completed</span>
</pre></div>
</div>



<div class="slide-no">25</div>


    </article>
  </slide>  <slide class="level-3" id="id21">
    <hgroup>
      <h3>IMAP</h3>
    </hgroup>
    <article class="">
      <p>What does IMAP look like?</p>
<p>IMAP (Say goodbye):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="n">A0006</span> <span class="n">LOGOUT</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="o">*</span> <span class="n">BYE</span> <span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="n">IMAP4rev1</span> <span class="n">server</span> <span class="n">terminating</span> <span class="n">connection</span>
<span class="n">S</span> <span class="p">(</span><span class="o">&lt;--</span><span class="p">):</span> <span class="n">A0006</span> <span class="n">OK</span> <span class="n">LOGOUT</span> <span class="n">completed</span>
<span class="n">C</span> <span class="p">(</span><span class="o">--&gt;</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">client</span> <span class="n">hangs</span> <span class="n">up</span><span class="o">&gt;</span>
</pre></div>
</div>



<div class="slide-no">26</div>


    </article>
  </slide>  <slide class="level-3" id="id22">
    <hgroup>
      <h3>IMAP Characteristics</h3>
    </hgroup>
    <article class="">
      <ul class="build simple">
<li>Interaction consists of commands and replies</li>
<li>Each command or reply is <em>one line</em> terminated by &lt;CRLF&gt;</li>
<li>Each command has a <em>verb</em> and one or more <em>arguments</em></li>
<li>Each reply has a formal <em>code</em> and an informal <em>explanation</em></li>
</ul>



<div class="slide-no">27</div>


    </article>
  </slide>  <slide class="level-3" id="id23">
    <hgroup>
      <h3>IMAP Differences</h3>
    </hgroup>
    <article class="">
      <div class="build docutils container">
<ul class="build simple">
<li>Commands and replies are prefixed by 'sequence identifier'</li>
<li>Payloads are prefixed by message size, rather than terminated by reserved
sequence</li>
</ul>
<p>Compared with POP3, what do these differences suggest?</p>
</div>



<div class="slide-no">28</div>


    </article>
  </slide>  <slide class="level-3" id="using-imap-in-python">
    <hgroup>
      <h3>Using IMAP in Python</h3>
    </hgroup>
    <article class="">
      <p>Let's try this out for ourselves!</p>
<div class="build docutils container">
<div class="docutils container">
Fire up your python interpreters and prepare to type.</div>
</div>



<div class="slide-no">29</div>


    </article>
  </slide>  <slide class="level-3" id="id24">
    <hgroup>
      <h3>Using IMAP in Python</h3>
    </hgroup>
    <article class="">
      <p>Begin by importing the <code class="docutils literal"><span class="pre">imaplib</span></code> module from the Python Standard Library:</p>
<div class="build docutils container">
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">imaplib</span>
<span class="gp">In [2]: </span><span class="nb">dir</span><span class="p">(</span><span class="n">imaplib</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">[&#39;AllowedVersions&#39;,</span>
<span class="go"> &#39;CRLF&#39;,</span>
<span class="go"> &#39;Commands&#39;,</span>
<span class="go">...</span>
<span class="go"> &#39;timedelta&#39;,</span>
<span class="go"> &#39;timezone&#39;]</span>
<span class="gp">In [3]: </span><span class="n">imaplib</span><span class="o">.</span><span class="n">Debug</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Setting <code class="docutils literal"><span class="pre">imap.Debug</span></code> shows us what is sent and received</p>
</div>



<div class="slide-no">30</div>


    </article>
  </slide>  <slide class="level-3" id="id25">
    <hgroup>
      <h3>Using IMAP in Python</h3>
    </hgroup>
    <article class="">
      <p>I've prepared a server for us to use, but we'll need to set up a client to
speak to it.</p>
<div class="build docutils container">
<p>Our server requires SSL (Secure Socket Layer) for connecting to IMAP
servers, so let's initialize an IMAP4_SSL client and authenticate:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">conn</span> <span class="o">=</span> <span class="n">imaplib</span><span class="o">.</span><span class="n">IMAP4_SSL</span><span class="p">(</span><span class="s1">&#39;mail.webfaction.com&#39;</span><span class="p">)</span>
<span class="go">  22:40.32 imaplib version 2.58</span>
<span class="go">  22:40.32 new IMAP4 connection, tag=b&#39;IMKC&#39;</span>
<span class="go">  22:40.38 &lt; b&#39;* OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN] Dovecot ready.&#39;</span>
<span class="go">  22:40.38 &gt; b&#39;IMKC0 CAPABILITY&#39;</span>
<span class="go">  22:40.45 &lt; b&#39;* CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN&#39;</span>
<span class="go">  22:40.45 &lt; b&#39;IMKC0 OK Capability completed.&#39;</span>
<span class="go">  22:40.45 CAPABILITIES: (&#39;IMAP4REV1&#39;, &#39;LITERAL+&#39;, &#39;SASL-IR&#39;, &#39;LOGIN-REFERRALS&#39;, &#39;ID&#39;, &#39;ENABLE&#39;, &#39;IDLE&#39;, &#39;AUTH=PLAIN&#39;)</span>
<span class="gp">In [5]: </span><span class="n">conn</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s1">&#39;crisewing_demobox&#39;</span><span class="p">,</span> <span class="s1">&#39;s00p3rs3cr3t&#39;</span><span class="p">)</span>
<span class="go">  22:59.92 &gt; b&#39;IMKC1 LOGIN crisewing_demobox &quot;s00p3rs3cr3t&quot;&#39;</span>
<span class="go">  23:01.79 &lt; b&#39;* CAPABILITY IMAP4rev1 SASL-IR SORT THREAD=REFERENCES MULTIAPPEND UNSELECT LITERAL+ IDLE CHILDREN NAMESPACE LOGIN-REFERRALS STARTTLS AUTH=PLAIN&#39;</span>
<span class="go">  23:01.79 &lt; b&#39;IMKC1 OK Logged in.&#39;</span>
<span class="gh">Out[5]: </span><span class="go">(&#39;OK&#39;, [b&#39;Logged in.&#39;])</span>
</pre></div>
</div>
</div>



<div class="slide-no">31</div>


    </article>
  </slide>  <slide class="level-3" id="id26">
    <hgroup>
      <h3>Using IMAP in Python</h3>
    </hgroup>
    <article class="">
      <p>We can start by listing the mailboxes we have on the server:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">conn</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">  26:30.64 &gt; b&#39;IMKC2 LIST &quot;&quot; *&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;Trash&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;Drafts&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;Sent&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;Junk&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;* LIST (\\HasNoChildren) &quot;.&quot; &quot;INBOX&quot;&#39;</span>
<span class="go">  26:30.72 &lt; b&#39;IMKC2 OK List completed.&#39;</span>
<span class="gh">Out[6]:</span>
<span class="go">(&#39;OK&#39;,</span>
<span class="go"> [b&#39;(\\HasNoChildren) &quot;.&quot; &quot;Trash&quot;&#39;,</span>
<span class="go">  b&#39;(\\HasNoChildren) &quot;.&quot; &quot;Drafts&quot;&#39;,</span>
<span class="go">  b&#39;(\\HasNoChildren) &quot;.&quot; &quot;Sent&quot;&#39;,</span>
<span class="go">  b&#39;(\\HasNoChildren) &quot;.&quot; &quot;Junk&quot;&#39;,</span>
<span class="go">  b&#39;(\\HasNoChildren) &quot;.&quot; &quot;INBOX&quot;&#39;])</span>
</pre></div>
</div>



<div class="slide-no">32</div>


    </article>
  </slide>  <slide class="level-3" id="id27">
    <hgroup>
      <h3>Using IMAP in Python</h3>
    </hgroup>
    <article class="">
      <p>To interact with our email, we must select a mailbox from the list we received
earlier:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">conn</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;INBOX&#39;</span><span class="p">)</span>
<span class="go">  27:20.96 &gt; b&#39;IMKC3 SELECT INBOX&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft)&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* OK [PERMANENTFLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft \\*)] Flags permitted.&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* 1 EXISTS&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* 0 RECENT&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* OK [UNSEEN 1] First unseen.&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* OK [UIDVALIDITY 1357449499] UIDs valid&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;* OK [UIDNEXT 24] Predicted next UID&#39;</span>
<span class="go">  27:21.04 &lt; b&#39;IMKC3 OK [READ-WRITE] Select completed.&#39;</span>
<span class="gh">Out[7]: </span><span class="go">(&#39;OK&#39;, [b&#39;1&#39;])</span>
</pre></div>
</div>



<div class="slide-no">33</div>


    </article>
  </slide>  <slide class="level-3" id="id28">
    <hgroup>
      <h3>Using IMAP in Python</h3>
    </hgroup>
    <article class="">
      <p>We can search our selected mailbox for messages matching one or more criteria.</p>
<div class="build docutils container">
<p>The return value is a list of bytestrings containing the UIDs of messages
that match our search:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">conn</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;(FROM &quot;cris&quot;)&#39;</span><span class="p">)</span>
<span class="go">  28:43.02 &gt; b&#39;IMKC4 SEARCH (FROM &quot;cris&quot;)&#39;</span>
<span class="go">  28:43.09 &lt; b&#39;* SEARCH 1&#39;</span>
<span class="go">  28:43.09 &lt; b&#39;IMKC4 OK Search completed.&#39;</span>
<span class="gh">Out[8]: </span><span class="go">(&#39;OK&#39;, [b&#39;1&#39;])</span>
</pre></div>
</div>
</div>



<div class="slide-no">34</div>


    </article>
  </slide>  <slide class="level-3" id="id29">
    <hgroup>
      <h3>Using IMAP in Python</h3>
    </hgroup>
    <article class="">
      <p>Once we've found a message we want to look at, we can use the <code class="docutils literal"><span class="pre">fetch</span></code>
command to read it from the server.</p>
<div class="build docutils container">
<p>IMAP allows fetching each part of a message independently:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">conn</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;BODY[HEADER]&#39;</span><span class="p">)</span>
<span class="go">  ...</span>
<span class="gh">Out[9]: </span><span class="go">(&#39;OK&#39;, ...)</span>

<span class="gp">In [10]: </span><span class="n">conn</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;FLAGS&#39;</span><span class="p">)</span>
<span class="go">  ...</span>
<span class="gh">Out[10]: </span><span class="go">(&#39;OK&#39;, [b&#39;1 (FLAGS (\\Seen))&#39;])</span>

<span class="gp">In [11]: </span><span class="n">conn</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;BODY[TEXT]&#39;</span><span class="p">)</span>
<span class="go">  ...</span>
<span class="gh">Out[11]: </span><span class="go">(&#39;OK&#39;, ...)</span>
</pre></div>
</div>
<p>What does the message say?</p>
</div>



<div class="slide-no">35</div>


    </article>
  </slide>  <slide class="level-3" id="id30">
    <hgroup>
      <h3>Batteries Included</h3>
    </hgroup>
    <article class="">
      <p>Python even includes an <em>email</em> library that would allow us to interact with
this message in an <em>OO</em> style.</p>
<div class="build docutils container">
<em>Neat, Huh?</em></div>



<div class="slide-no">36</div>


    </article>
  </slide>  <slide class="level-3" id="what-have-we-learned">
    <hgroup>
      <h3>What Have We Learned?</h3>
    </hgroup>
    <article class="">
      <div class="build docutils container">
<ul class="build simple">
<li>Protocols are just a set of rules for how to communicate</li>
<li>Protocols tell us how to parse and delimit messages</li>
<li>Protocols tell us what messages are valid</li>
<li>If we properly format request messages to a server, we can get response
messages</li>
<li>Python supports a number of these protocols</li>
<li>So we don't have to remember how to format the commands ourselves</li>
</ul>
<p>But in every case we've seen, we could do the same thing with a socket and
some strings</p>
</div>



<div class="slide-no">37</div>


    </article>
  </slide>  <slide class="level-3" id="break-time">
    <hgroup>
      <h3>Break Time</h3>
    </hgroup>
    <article class="">
      <p>Let's take a few minutes here to clear our heads.</p>
<div class="build docutils container">
<p>When we return, we'll learn about the king of protocols,</p>
<p class="large centered">HTTP</p>
</div>



<div class="slide-no">38</div>


    </article>
  </slide>  <slide class="level-2" id="http">
    <hgroup>
      <h2>HTTP</h2>
    </hgroup>
    <article class="">
      <div class="left docutils container">
<p>HTTP is no different</p>
<div class="build docutils container">
<p>HTTP is also message-centered, with two-way communications:</p>
<ul class="build simple">
<li>Requests (Asking for information)</li>
<li>Responses (Providing answers)</li>
</ul>
</div>
</div>



<div class="slide-no">39</div>


    </article>
  </slide>  <slide class="level-3" id="what-does-http-look-like">
    <hgroup>
      <h3>What does HTTP look like?</h3>
    </hgroup>
    <article class="">
      <p>HTTP (Ask for information):</p>
<div class="highlight-http"><div class="highlight"><pre><span></span>GET /index.html HTTP/1.1&lt;CRLF&gt;
Host: www.example.com&lt;CRLF&gt;
&lt;CRLF&gt;
</pre></div>
</div>
<p><strong>note</strong>: the <code class="docutils literal"><span class="pre">&lt;CRLF&gt;</span></code> you see here is a visualization of the <code class="docutils literal"><span class="pre">\r\n</span></code>
character sequence.</p>



<div class="slide-no">40</div>


    </article>
  </slide>  <slide class="level-3" id="id31">
    <hgroup>
      <h3>What does HTTP look like?</h3>
    </hgroup>
    <article class="">
      <p>HTTP (Provide answers):</p>
<div class="highlight-http"><div class="highlight"><pre><span></span>HTTP/1.1 200 OK
Date: Mon, 23 May 2005 22:38:34 GMT
Server: Apache/1.3.3.7 (Unix) (Red-Hat/Linux)
Last-Modified: Wed, 08 Jan 2003 23:11:55 GMT
Etag: &quot;3f80f-1b6-3e1cb03b&quot;
Accept-Ranges:  none
Content-Length: 438
Connection: close
Content-Type: text/html; charset=UTF-8
&lt;CRLF&gt;
&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;This is a .... &lt;/html&gt;
</pre></div>
</div>
<p>Pay particular attention to the <code class="docutils literal"><span class="pre">&lt;CRLF&gt;</span></code> on a line by itself.</p>



<div class="slide-no">41</div>


    </article>
  </slide>  <slide class="level-3" id="id32">
    <hgroup>
      <h3>HTTP Core Format</h3>
    </hgroup>
    <article class="">
      <p>In HTTP, both <em>request</em> and <em>response</em> share a common basic format:</p>
<ul class="build simple">
<li>Line separators are &lt;CRLF&gt; (familiar, no?)</li>
<li>A required initial line (a command or a response code)</li>
<li>A (mostly) optional set of headers, one per line</li>
<li>A blank line</li>
<li>An optional body</li>
</ul>



<div class="slide-no">42</div>


    </article>
  </slide>  <slide class="level-3" id="implementing-http">
    <hgroup>
      <h3>Implementing HTTP</h3>
    </hgroup>
    <article class="">
      <p>Let's investigate the HTTP protocol a bit in real life.</p>
<div class="build docutils container">
<p>We'll do so by building a simplified HTTP server, one step at a time.</p>
<p>There is a copy of the echo server from last time in
<code class="docutils literal"><span class="pre">resources/session02</span></code>. It's called <code class="docutils literal"><span class="pre">http_server.py</span></code>.</p>
<p>In a terminal, move into that directory. We'll be doing our work here for
the rest of the session</p>
</div>



<div class="slide-no">43</div>


    </article>
  </slide>  <slide class="level-3" id="id33">
    <hgroup>
      <h3>TDD IRL (a quick aside)</h3>
    </hgroup>
    <article class="">
      <p>Test Driven Development (TDD) is all the rage these days.</p>
<div class="build docutils container">
<p>It means that before you write code, you first write tests demonstrating
what you want your code to do.</p>
<p>When all your tests pass, you are finished. You did this for your last
assignment.</p>
<p>We'll be doing it again today.</p>
</div>



<div class="slide-no">44</div>


    </article>
  </slide>  <slide class="level-3" id="id34">
    <hgroup>
      <h3>Run the Tests</h3>
    </hgroup>
    <article class="">
      <p>From inside <code class="docutils literal"><span class="pre">resources/session02</span></code> start a second python interpreter and run
<code class="docutils literal"><span class="pre">$</span> <span class="pre">python</span> <span class="pre">http_server.py</span></code></p>
<div class="build docutils container">
<p>In your first interpreter run the tests. You should see similar output:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ python tests.py
<span class="o">[</span>...<span class="o">]</span>
Ran <span class="m">10</span> tests in 0.054s

FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span>3, <span class="nv">errors</span><span class="o">=</span>7<span class="o">)</span>
</pre></div>
</div>
<p>Let's take a few minutes here to look at these tests and understand them.</p>
</div>



<div class="slide-no">45</div>


    </article>
  </slide>  <slide class="level-3" id="id35">
    <hgroup>
      <h3>Viewing an HTTP Request</h3>
    </hgroup>
    <article class="">
      <p>Our job is to make all those tests pass.</p>
<div class="build docutils container">
<p>First, though, let's pretend this server really is a functional HTTP
server.</p>
<p>This time, instead of using the echo client to make a connection to the
server, let's use a web browser!</p>
<p>Point your favorite browser at <code class="docutils literal"><span class="pre">http://localhost:10000</span></code></p>
</div>



<div class="slide-no">46</div>


    </article>
  </slide>  <slide class="level-3" id="id36">
    <hgroup>
      <h3>A Bad Interaction</h3>
    </hgroup>
    <article class="">
      <p>First, look at the printed output from your echo server.</p>
<div class="build docutils container">
<p>Second, note that your browser is still waiting to finish loading the page</p>
<p>Moreover, your server should also be hung, waiting for more from the
'client'</p>
<p>This is because the server is waiting for the browser to respond</p>
<p>And at the same time, the browser is waiting for the server to indicate it
is done.</p>
<p>Our server does not yet speak the HTTP protocol, but the browser is
expecting it.</p>
</div>



<div class="slide-no">47</div>


    </article>
  </slide>  <slide class="level-3" id="id37">
    <hgroup>
      <h3>Echoing A Request</h3>
    </hgroup>
    <article class="">
      <p>Kill your server with <code class="docutils literal"><span class="pre">ctrl-c</span></code> (the keyboard interrupt) and you should see
some printed content in your browser:</p>
<div class="build docutils container">
<div class="highlight-http"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:10000</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:22.0) Gecko/20100101 Firefox/22.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">DNT</span><span class="o">:</span> <span class="l">1</span>
<span class="na">Cookie</span><span class="o">:</span> <span class="l">__utma=111872281.383966302.1364503233.1364503233.1364503233.1; __utmz=111872281.1364503233.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); csrftoken=uiqj579iGRbReBHmJQNTH8PFfAz2qRJS</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">max-age=0</span>
</pre></div>
</div>
<p>Your server is simply echoing what it receives, so this is an <em>HTTP
Request</em> as sent by your browser.</p>
</div>



<div class="slide-no">48</div>


    </article>
  </slide>  <slide class="level-3" id="id38">
    <hgroup>
      <h3>HTTP Debugging</h3>
    </hgroup>
    <article class="">
      <p>When working on HTTP applications, it's nice to be able to see all this going back
and forth.</p>
<div class="build docutils container">
<p>Good browsers support this with a set of developer tools built-in.</p>
<ul class="build simple">
<li>firefox -&gt; ctrl-shift-K or cmd-opt-K (os X)</li>
<li>safari -&gt; enable in preferences:advanced then cmd-opt-i</li>
<li>chrome -&gt; ctrl-shift-i or cmd-opt-i (os X)</li>
<li>IE (7.0+) -&gt; F12 or tools menu -&gt; developer tools</li>
</ul>
<p>The 'Net(work)' pane of these tools can show you both request and response,
headers and all. Very useful.</p>
</div>



<div class="slide-no">49</div>


    </article>
  </slide>  <slide class="level-3" id="id39">
    <hgroup>
      <h3>Stop! Demo Time</h3>
    </hgroup>
    <article class="">
      <p class="centered"><strong>Let's take a quick look</strong></p>



<div class="slide-no">50</div>


    </article>
  </slide>  <slide class="level-3" id="id40">
    <hgroup>
      <h3>Other Debugging Options</h3>
    </hgroup>
    <article class="">
      <p>Sometimes you need or want to debug http requests that are not going through
your browser.</p>
<div class="build docutils container">
<p>Or perhaps you need functionality that is not supported by in-browser tools
(request munging, header mangling, decryption of https request/responses)</p>
<p>Then it might be time for an HTTP debugging proxy:</p>
<ul class="build simple">
<li>windows: <a class="reference external" href="http://www.fiddler2.com/fiddler2/">http://www.fiddler2.com/fiddler2/</a></li>
<li>win/osx/linux: <a class="reference external" href="http://www.charlesproxy.com/">http://www.charlesproxy.com/</a></li>
</ul>
<p>We won't cover any of these tools here today.  But you can check them out
when you have the time.</p>
</div>



<div class="slide-no">51</div>


    </article>
  </slide>  <slide class="level-3" id="step-1-basic-http-protocol">
    <hgroup>
      <h3>Step 1: Basic HTTP Protocol</h3>
    </hgroup>
    <article class="">
      <p>In HTTP 1.0, the only required line in an HTTP request is this:</p>
<div class="highlight-http"><div class="highlight"><pre><span></span>GET /path/to/index.html HTTP/1.0&lt;CRLF&gt;
&lt;CRLF&gt;
</pre></div>
</div>
<div class="build docutils container">
<p>As virtual hosting grew more common, that was not enough, so HTTP 1.1 adds
a single required <em>header</em>, <strong>Host</strong>:</p>
<div class="highlight-http"><div class="highlight"><pre><span></span>GET /path/to/index.html HTTP/1.1&lt;CRLF&gt;
Host: www.mysite1.com:80&lt;CRLF&gt;
&lt;CRLF&gt;
</pre></div>
</div>
</div>



<div class="slide-no">52</div>


    </article>
  </slide>  <slide class="level-3" id="id41">
    <hgroup>
      <h3>HTTP Responses</h3>
    </hgroup>
    <article class="">
      <p>In both HTTP 1.0 and 1.1, a proper response consists of an intial line,
followed by optional headers, a single blank line, and then optionally a
response body:</p>
<div class="build docutils container">
<div class="highlight-http"><div class="highlight"><pre><span></span>HTTP/1.1 200 OK&lt;CRLF&gt;
Content-Type: text/plain&lt;CRLF&gt;
&lt;CRLF&gt;
this is a pretty minimal response
</pre></div>
</div>
<p>Let's update our server to return such a response.</p>
</div>



<div class="slide-no">53</div>


    </article>
  </slide>  <slide class="level-3" id="id42">
    <hgroup>
      <h3>Returning a Canned HTTP Response</h3>
    </hgroup>
    <article class="">
      <p>Begin by implementing a new function in your <code class="docutils literal"><span class="pre">http_server.py</span></code> script called
<cite>response_ok</cite>.</p>
<div class="build docutils container">
<p>It can be super-simple for now.  We'll improve it later.</p>
<div class="docutils container">
<p>It needs to return our minimal response from above:</p>
<div class="highlight-http"><div class="highlight"><pre><span></span>HTTP/1.1 200 OK&lt;CRLF&gt;
Content-Type: text/plain&lt;CRLF&gt;
&lt;CRLF&gt;
this is a pretty minimal response
</pre></div>
</div>
</div>
<p><strong>Remember, &lt;CRLF&gt; is a placeholder for the</strong> <code class="docutils literal"><span class="pre">\r\n</span></code> <strong>character sequence</strong></p>
</div>



<div class="slide-no">54</div>


    </article>
  </slide>  <slide class="level-3" id="id43">
    <hgroup>
      <h3>My Solution</h3>
    </hgroup>
    <article class="">
      <div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">response_ok</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;returns a basic HTTP response&quot;&quot;&quot;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s2">&quot;HTTP/1.1 200 OK&quot;</span><span class="p">)</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s2">&quot;Content-Type: text/plain&quot;</span><span class="p">)</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s2">&quot;this is a pretty minimal response&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
</pre></div>
</div>
<p>Did you remember that sockets only accept bytes?</p>



<div class="slide-no">55</div>


    </article>
  </slide>  <slide class="level-3" id="id44">
    <hgroup>
      <h3>Run The Tests</h3>
    </hgroup>
    <article class="">
      <p>We've now implemented a function that is tested by our tests. Let's run them
again:</p>
<div class="build docutils container">
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ python tests.py
<span class="o">[</span>...<span class="o">]</span>
----------------------------------------------------------------------
Ran <span class="m">10</span> tests in 0.002s

FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span>3, <span class="nv">errors</span><span class="o">=</span>3<span class="o">)</span>
</pre></div>
</div>
<p>Great!  We've now got 4 tests that pass.  Good work.</p>
</div>



<div class="slide-no">56</div>


    </article>
  </slide>  <slide class="level-3" id="id45">
    <hgroup>
      <h3>Server Modifications</h3>
    </hgroup>
    <article class="">
      <p>Next, we need to rebuild the server loop from our echo server for it's new
purpose:</p>
<div class="build docutils container">
<p>It should now wait for an incoming request to be <em>finished</em>, <em>then</em> send a
response back to the client.</p>
<p>The response it sends can be the result of calling our new <code class="docutils literal"><span class="pre">response_ok</span></code>
function for now.</p>
<p>We could also bump up the <code class="docutils literal"><span class="pre">recv</span></code> buffer size to something more reasonable
for HTTP traffic, say 1024.</p>
</div>



<div class="slide-no">57</div>


    </article>
  </slide>  <slide class="level-3" id="id46">
    <hgroup>
      <h3>My Solution</h3>
    </hgroup>
    <article class="">
      <div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># ...</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;waiting for a connection&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
        <span class="n">conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>  <span class="c1"># blocking</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;connection - {0}:{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">addr</span><span class="p">),</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;sending response&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">response_ok</span><span class="p">()</span>
            <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># ...</span>
</pre></div>
</div>



<div class="slide-no">58</div>


    </article>
  </slide>  <slide class="level-3" id="id47">
    <hgroup>
      <h3>Run The Tests</h3>
    </hgroup>
    <article class="">
      <p>Once you've got that set, restart your server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python http_server.py
</pre></div>
</div>
<div class="build docutils container">
<p>Then you can re-run your tests:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ python tests.py
<span class="o">[</span>...<span class="o">]</span>
----------------------------------------------------------------------
Ran <span class="m">10</span> tests in 0.003s

FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span>2, <span class="nv">errors</span><span class="o">=</span>3<span class="o">)</span>
</pre></div>
</div>
<p>Five tests now pass!</p>
</div>



<div class="slide-no">59</div>


    </article>
  </slide>  <slide class="level-3" id="step-2-handling-http-methods">
    <hgroup>
      <h3>Step 2: Handling HTTP Methods</h3>
    </hgroup>
    <article class="">
      <p>Every HTTP request <strong>must</strong> begin with a single line, broken by whitespace into
three parts:</p>
<div class="highlight-http"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/path/to/index.html</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>
</div>
<div class="build docutils container">
<p>The three parts are the <em>method</em>, the <em>URI</em>, and the <em>protocol</em></p>
<p>Let's look at each in turn.</p>
</div>



<div class="slide-no">60</div>


    </article>
  </slide>  <slide class="level-3" id="id48">
    <hgroup>
      <h3>HTTP Methods</h3>
    </hgroup>
    <article class="">
      <p><strong>GET</strong> <code class="docutils literal"><span class="pre">/path/to/index.html</span> <span class="pre">HTTP/1.1</span></code></p>
<ul class="build simple">
<li>Every HTTP request must start with a <em>method</em></li>
<li>There are four main HTTP methods:<ul class="build">
<li>GET</li>
<li>POST</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
</li>
<li>There are others, notably HEAD, but you won't see them too much</li>
</ul>



<div class="slide-no">61</div>


    </article>
  </slide>  <slide class="level-3" id="id49">
    <hgroup>
      <h3>HTTP Methods</h3>
    </hgroup>
    <article class="">
      <p>These four methods are mapped to the four basic steps (<em>CRUD</em>) of persistent
storage:</p>
<ul class="build simple">
<li>POST = Create</li>
<li>GET = Read</li>
<li>PUT = Update</li>
<li>DELETE = Delete</li>
</ul>



<div class="slide-no">62</div>


    </article>
  </slide>  <slide class="level-3" id="id50">
    <hgroup>
      <h3>Methods: Safe &lt;--&gt; Unsafe</h3>
    </hgroup>
    <article class="">
      <p>HTTP methods can be categorized as <strong>safe</strong> or <strong>unsafe</strong>, based on whether
they might change something on the server:</p>
<div class="build docutils container">
<ul class="build simple">
<li>Safe HTTP Methods<ul>
<li>GET</li>
</ul>
</li>
<li>Unsafe HTTP Methods<ul>
<li>POST</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
</li>
</ul>
<p>This is a <em>normative</em> distinction, which is to say <strong>be careful</strong></p>
</div>



<div class="slide-no">63</div>


    </article>
  </slide>  <slide class="level-3" id="id51">
    <hgroup>
      <h3>Methods: Idempotent &lt;--&gt; ???</h3>
    </hgroup>
    <article class="">
      <p>HTTP methods can be categorized as <strong>idempotent</strong>.</p>
<div class="build docutils container">
<p>This means that a given request will always have the same result:</p>
<ul class="build simple">
<li>Idempotent HTTP Methods<ul>
<li>GET</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
</li>
<li>Non-Idempotent HTTP Methods<ul>
<li>POST</li>
</ul>
</li>
</ul>
<p>Again, <em>normative</em>. The developer is responsible for ensuring that it is true.</p>
</div>



<div class="slide-no">64</div>


    </article>
  </slide>  <slide class="level-3" id="id52">
    <hgroup>
      <h3>HTTP Method Handling</h3>
    </hgroup>
    <article class="">
      <p>Let's keep things simple, our server will only respond to <em>GET</em> requests.</p>
<div class="build docutils container">
<p>We need to create a function that parses a request and determines if we can
respond to it: <code class="docutils literal"><span class="pre">parse_request</span></code>.</p>
<p>If the request method is not <em>GET</em>, our method should raise an error</p>
<p>Remember, although a request is more than one line long, all we care about
here is the first line</p>
</div>



<div class="slide-no">65</div>


    </article>
  </slide>  <slide class="level-3" id="id53">
    <hgroup>
      <h3>My Solution</h3>
    </hgroup>
    <article class="">
      <div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">first_line</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">method</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">protocol</span> <span class="o">=</span> <span class="n">first_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;We only accept GET&quot;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;request is okay&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</pre></div>
</div>



<div class="slide-no">66</div>


    </article>
  </slide>  <slide class="level-3" id="id54">
    <hgroup>
      <h3>Update the Server</h3>
    </hgroup>
    <article class="">
      <p>We'll also need to update the server code. It should</p>
<ul class="build simple">
<li>save the request as it comes in</li>
<li>check the request using our new function</li>
<li>send an OK response if things go well</li>
</ul>



<div class="slide-no">67</div>


    </article>
  </slide>  <slide class="level-3" id="id55">
    <hgroup>
      <h3>My Solution</h3>
    </hgroup>
    <article class="">
      <div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># ...</span>
<span class="n">conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span> <span class="c1"># blocking</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;connection - {0}:{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">addr</span><span class="p">),</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
    <span class="n">request</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">request</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="n">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;sending response&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response_ok</span><span class="p">()</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># ...</span>
</pre></div>
</div>



<div class="slide-no">68</div>


    </article>
  </slide>  <slide class="level-3" id="id56">
    <hgroup>
      <h3>Run The Tests</h3>
    </hgroup>
    <article class="">
      <p>Quit and restart your server now that you've updated the code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python http_server.py
</pre></div>
</div>
<div class="build docutils container">
<p>At this point, we should have seven tests passing:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ python tests.py
Ran <span class="m">10</span> tests in 0.002s

FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span>1, <span class="nv">errors</span><span class="o">=</span>2<span class="o">)</span>
</pre></div>
</div>
</div>



<div class="slide-no">69</div>


    </article>
  </slide>  <slide class="level-3" id="id57">
    <hgroup>
      <h3>What About a Browser?</h3>
    </hgroup>
    <article class="">
      <p>The server quit during the tests, but an HTTP request from the browser should
work fine now.</p>
<div class="build docutils container">
<p>Restart the server and reload your browser.  You should see your OK
response.</p>
<p>We can use the <code class="docutils literal"><span class="pre">simple_client.py</span></code> script in our resources to test our
error condition.  In a second terminal window run the script like so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python simple_client.py &quot;POST / HTTP/1.0\r\n\r\n&quot;
</pre></div>
</div>
<p>This should cause the server to crash.</p>
</div>



<div class="slide-no">70</div>


    </article>
  </slide>  <slide class="level-3" id="step-3-error-responses">
    <hgroup>
      <h3>Step 3: Error Responses</h3>
    </hgroup>
    <article class="">
      <p>Okay, so the outcome there was pretty ugly. The client went off the rails, and
our server has terminated as well.</p>
<div class="build docutils container">
<p class="centered"><strong>why?</strong></p>
<p>The HTTP protocol allows us to handle errors like this more gracefully.</p>
<p class="centered"><strong>Enter the Response Code</strong></p>
</div>



<div class="slide-no">71</div>


    </article>
  </slide>  <slide class="level-3" id="id58">
    <hgroup>
      <h3>HTTP Response Codes</h3>
    </hgroup>
    <article class="">
      <p><code class="docutils literal"><span class="pre">HTTP/1.1</span></code> <strong>200 OK</strong></p>
<p>All HTTP responses must include a <strong>response code</strong> indicating the outcome of
the request.</p>
<div class="build docutils container">
<ul class="build simple">
<li>1xx (HTTP 1.1 only) - Informational message</li>
<li>2xx - Success of some kind</li>
<li>3xx - Redirection of some kind</li>
<li>4xx - Client Error of some kind</li>
<li>5xx - Server Error of some kind</li>
</ul>
<p>The text bit makes the code more human-readable</p>
</div>



<div class="slide-no">72</div>


    </article>
  </slide>  <slide class="level-3" id="id59">
    <hgroup>
      <h3>Common Response Codes</h3>
    </hgroup>
    <article class="">
      <p>There are certain HTTP response codes you are likely to see (and use) most
often:</p>
<div class="build docutils container">
<ul class="build simple">
<li><code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code> - Everything is good</li>
<li><code class="docutils literal"><span class="pre">301</span> <span class="pre">Moved</span> <span class="pre">Permanently</span></code> - You should update your link</li>
<li><code class="docutils literal"><span class="pre">304</span> <span class="pre">Not</span> <span class="pre">Modified</span></code> - You should load this from cache</li>
<li><code class="docutils literal"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code> - You've asked for something that doesn't exist</li>
<li><code class="docutils literal"><span class="pre">500</span> <span class="pre">Internal</span> <span class="pre">Server</span> <span class="pre">Error</span></code> - Something bad happened</li>
</ul>
<p>Do not be afraid to use other, less common codes in building good apps.
There are a lot of them for a reason.</p>
<p>See <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</a></p>
</div>



<div class="slide-no">73</div>


    </article>
  </slide>  <slide class="level-3" id="id60">
    <hgroup>
      <h3>Handling our Error</h3>
    </hgroup>
    <article class="">
      <p>Luckily, there's an error code that is tailor-made for this situation.</p>
<div class="build docutils container">
<p>The client has made a request using a method we do not support</p>
<p><code class="docutils literal"><span class="pre">405</span> <span class="pre">Method</span> <span class="pre">Not</span> <span class="pre">Allowed</span></code></p>
<p>Let's add a new function that returns this error code. It should be called
<code class="docutils literal"><span class="pre">response_method_not_allowed</span></code></p>
<p>Remember, it must be a complete HTTP Response with the correct <em>code</em></p>
</div>



<div class="slide-no">74</div>


    </article>
  </slide>  <slide class="level-3" id="id61">
    <hgroup>
      <h3>My Solution</h3>
    </hgroup>
    <article class="">
      <div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">response_method_not_allowed</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;returns a 405 Method Not Allowed response&quot;&quot;&quot;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s2">&quot;HTTP/1.1 405 Method Not Allowed&quot;</span><span class="p">)</span>
    <span class="n">resp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
</pre></div>
</div>



<div class="slide-no">75</div>


    </article>
  </slide>  <slide class="level-3" id="id62">
    <hgroup>
      <h3>Server Updates</h3>
    </hgroup>
    <article class="">
      <p>Again, we'll need to update the server to handle this error condition
correctly.  It should</p>
<ul class="build simple">
<li>catch the exception raised by the <code class="docutils literal"><span class="pre">parse_request</span></code> function</li>
<li>create our new error response as a result</li>
<li>if no exception is raised, then create the OK response</li>
<li>return the generated response to the user</li>
</ul>



<div class="slide-no">76</div>


    </article>
  </slide>  <slide class="level-3" id="id63">
    <hgroup>
      <h3>My Solution</h3>
    </hgroup>
    <article class="">
      <div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># ...</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">request</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
        <span class="k">break</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response_method_not_allowed</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response_ok</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;sending response&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">log_buffer</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="c1"># ...</span>
</pre></div>
</div>



<div class="slide-no">77</div>


    </article>
  </slide>  <slide class="level-3" id="id64">
    <hgroup>
      <h3>Run The Tests</h3>
    </hgroup>
    <article class="">
      <p>Start your server (or restart it if by some miracle it's still going).</p>
<div class="build docutils container">
<p>Then run the tests again:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python tests.py
[...]
Ran 10 tests in 0.002s

OK
</pre></div>
</div>
<p>Wahoo! All our tests are passing. That means we are done writing code for
now.</p>
</div>



<div class="slide-no">78</div>


    </article>
  </slide>  <slide class="level-3" id="step-4-serving-resources">
    <hgroup>
      <h3>Step 4: Serving Resources</h3>
    </hgroup>
    <article class="">
      <p>We've got a very simple server that accepts a request and sends a response.
But what happens if we make a different request?</p>
<div class="build docutils container">
<div class="docutils container">
<p>In your web browser, enter the following URL:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">10000</span><span class="o">/</span><span class="n">page</span>
</pre></div>
</div>
</div>
<div class="docutils container">
<p>What happened? What happens if you use this URL:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>http://localhost:10000/section/page?
</pre></div>
</div>
</div>
</div>



<div class="slide-no">79</div>


    </article>
  </slide>  <slide class="level-3" id="id65">
    <hgroup>
      <h3>Determining a Resource</h3>
    </hgroup>
    <article class="">
      <p>We expect different urls to result in different responses.</p>
<div class="build docutils container">
<p>Each separate <em>path</em> provided should map to a <em>resource</em></p>
<p>But this isn't happening with our server, for obvious reasons.</p>
<p>It brings us back to the second element of that first line of an HTTP
request.</p>
<p class="centered"><strong>The Return of the URI</strong></p>
</div>



<div class="slide-no">80</div>


    </article>
  </slide>  <slide class="level-3" id="id66">
    <hgroup>
      <h3>HTTP Requests: URI</h3>
    </hgroup>
    <article class="">
      <p><code class="docutils literal"><span class="pre">GET</span></code> <strong>/path/to/index.html</strong> <code class="docutils literal"><span class="pre">HTTP/1.1</span></code></p>
<ul class="build simple">
<li>Every HTTP request must include a <strong>URI</strong> used to determine the <strong>resource</strong> to
be returned</li>
<li>URI??
<a class="reference external" href="http://stackoverflow.com/questions/176264/whats-the-difference-between-a-uri-and-a-url/1984225#1984225">http://stackoverflow.com/questions/176264/whats-the-difference-between-a-uri-and-a-url/1984225#1984225</a></li>
<li>Resource?  Files (html, img, .js, .css), but also:<ul class="build">
<li>Dynamic scripts</li>
<li>Raw data</li>
<li>API endpoints</li>
</ul>
</li>
</ul>



<div class="slide-no">81</div>


    </article>
  </slide>  <slide class="level-3" id="id67">
    <hgroup>
      <h3>Parsing a Request</h3>
    </hgroup>
    <article class="">
      <p>Our <code class="docutils literal"><span class="pre">parse_request</span></code> method actually already finds the <code class="docutils literal"><span class="pre">uri</span></code> in the first
line of a request</p>
<div class="build docutils container">
<p>All we need to do is update the method so that it <em>returns</em> that uri</p>
<p>Then we can use it.</p>
</div>



<div class="slide-no">82</div>


    </article>
  </slide>  <slide class="level-3" id="id68">
    <hgroup>
      <h3>My Solution</h3>
    </hgroup>
    <article class="">
      <div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">first_line</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">method</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">protocol</span> <span class="o">=</span> <span class="n">first_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;We only accept GET&quot;</span><span class="p">)</span>
    <span class="k">print</span> <span class="o">&gt;&gt;</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s1">&#39;request is okay&#39;</span>
    <span class="c1"># add the following line:</span>
    <span class="k">return</span> <span class="n">uri</span>
</pre></div>
</div>



<div class="slide-no">83</div>


    </article>
  </slide>  <slide class="level-3" id="id69">
    <hgroup>
      <h3>Pass It Along</h3>
    </hgroup>
    <article class="">
      <p>Now we can update our server code so that it uses the return value of
<code class="docutils literal"><span class="pre">parse_request</span></code>.</p>
<div class="build docutils container">
<p>That's a pretty simple change:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="n">parse_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>  <span class="c1"># update this line</span>
<span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response_method_not_allowed</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># and modify this block</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">content</span><span class="p">,</span> <span class="n">mime_type</span> <span class="o">=</span> <span class="n">resolve_uri</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">response_not_found</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">response_ok</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">mime_type</span><span class="p">)</span>
</pre></div>
</div>
</div>



<div class="slide-no">84</div>


    </article>
  </slide>  <slide class="level-2" id="homework">
    <hgroup>
      <h2>Homework</h2>
    </hgroup>
    <article class="">
      <div class="left docutils container">
<p>You may have noticed that we just added calls to functions that don't yet
exist</p>
<div class="build docutils container">
<p>It's a program that shows you what you want to do, but won't actually
run.</p>
<p>For your homework this week you will create these functions, completing
the HTTP server.</p>
<p>Your starting point will be what we've made here in class.</p>
<p>I've added a directory to <code class="docutils literal"><span class="pre">resources/session02</span></code> called <code class="docutils literal"><span class="pre">homework</span></code>.</p>
<p>In it, you'll find this <code class="docutils literal"><span class="pre">http_server.py</span></code> file we've just written in
class.</p>
<p>That file also contains enough stub code for the missing functions to
let the server run.</p>
<p>And there are more tests for you to make pass!</p>
</div>
</div>



<div class="slide-no">85</div>


    </article>
  </slide>  <slide class="level-3" id="one-step-at-a-time">
    <hgroup>
      <h3>One Step At A Time</h3>
    </hgroup>
    <article class="">
      <p>Take the following steps one at a time. Run the tests in
<code class="docutils literal"><span class="pre">assignments/session02/homework</span></code> between to ensure that you are getting it
right.</p>
<ul class="build simple">
<li>Complete the stub <code class="docutils literal"><span class="pre">resolve_uri</span></code> function so that it handles looking up
resources on disk using the URI returned by <code class="docutils literal"><span class="pre">parse_request</span></code>.</li>
<li>Make sure that if the URI does not map to a file that exists, it raises an
appropriate error for our server to handle.</li>
<li>Complete the <code class="docutils literal"><span class="pre">response_not_found</span></code> function stub so that it returns a 404
response.</li>
<li>Update <code class="docutils literal"><span class="pre">response_ok</span></code> so that it uses the values returned by <code class="docutils literal"><span class="pre">resolve_uri</span></code>
by the URI. (these have already been added to the function signature)</li>
<li>You'll plug those values into the response you generate in the way required
by the protocol</li>
</ul>



<div class="slide-no">86</div>


    </article>
  </slide>  <slide class="level-3" id="http-headers">
    <hgroup>
      <h3>HTTP Headers</h3>
    </hgroup>
    <article class="">
      <p>Along the way, you'll discover that simply returning the content of a file as
an HTTP response body is insufficient. Different <em>types</em> of content need to
be identified to your browser</p>
<div class="build docutils container">
<p>We can fix this by passing information about exactly what we are returning
as part of the response.</p>
<p>HTTP provides for this type of thing with the generic idea of <em>Headers</em></p>
</div>



<div class="slide-no">87</div>


    </article>
  </slide>  <slide class="level-3" id="id1">
    <hgroup>
      <h3>HTTP Headers</h3>
    </hgroup>
    <article class="">
      <p>Both requests and responses can contain <strong>headers</strong> of the form <code class="docutils literal"><span class="pre">Name:</span> <span class="pre">Value</span></code></p>
<div class="build docutils container">
<ul class="build simple">
<li>HTTP 1.0 has 16 valid headers, 1.1 has 46</li>
<li>Any number of spaces or tabs may separate the <em>name</em> from the <em>value</em></li>
<li>If a header line starts with spaces or tabs, it is considered part of the
value for the previous header</li>
<li>Header <em>names</em> are <strong>not</strong> case-sensitive, but <em>values</em> may be</li>
</ul>
<p>read more about HTTP headers: <a class="reference external" href="http://www.cs.tut.fi/~jkorpela/http.html">http://www.cs.tut.fi/~jkorpela/http.html</a></p>
</div>



<div class="slide-no">88</div>


    </article>
  </slide>  <slide class="level-3" id="content-type-header">
    <hgroup>
      <h3>Content-Type Header</h3>
    </hgroup>
    <article class="">
      <p>A very common header used in HTTP responses is <code class="docutils literal"><span class="pre">Content-Type</span></code>. It tells the
client what to expect.</p>
<div class="build docutils container">
<ul class="build simple">
<li>uses <strong>mime-type</strong> (Multi-purpose Internet Mail Extensions)</li>
<li>foo.jpeg - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">image/jpeg</span></code></li>
<li>foo.png - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">image/png</span></code></li>
<li>bar.txt - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">text/plain</span></code></li>
<li>baz.html - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">text/html</span></code></li>
</ul>
<p>There are <em>many</em> mime-type identifiers:
<a class="reference external" href="http://www.freeformatter.com/mime-types-list.html">http://www.freeformatter.com/mime-types-list.html</a></p>
</div>



<div class="slide-no">89</div>


    </article>
  </slide>  <slide class="level-3" id="mapping-mime-types">
    <hgroup>
      <h3>Mapping Mime-types</h3>
    </hgroup>
    <article class="">
      <p>By mapping a given file to a mime-type, we can write a header.</p>
<div class="build docutils container">
<p>The standard lib module <code class="docutils literal"><span class="pre">mimetypes</span></code> does just this.</p>
<p>We can guess the mime-type of a file based on the filename or map a file
extension to a type:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mimetypes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="s1">&#39;file.txt&#39;</span><span class="p">)</span>
<span class="go">(&#39;text/plain&#39;, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mimetypes</span><span class="o">.</span><span class="n">types_map</span><span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">]</span>
<span class="go">&#39;text/plain&#39;</span>
</pre></div>
</div>
</div>



<div class="slide-no">90</div>


    </article>
  </slide>  <slide class="level-3" id="resolving-a-uri">
    <hgroup>
      <h3>Resolving a URI</h3>
    </hgroup>
    <article class="">
      <p>Your <code class="docutils literal"><span class="pre">resolve_uri</span></code> function will need to accomplish the following tasks:</p>
<ul class="build simple">
<li>It should take a URI as the sole argument</li>
<li>It should map the pathname represented by the URI to a filesystem location.</li>
<li>It should have a 'home directory', and look only in that location.</li>
<li>If the URI is a directory, it should return a plain-text listing of the
directory contents and the mimetype <code class="docutils literal"><span class="pre">text/plain</span></code>.</li>
<li>If the URI is a file, it should return the contents of that file and its
correct mimetype.</li>
<li>If the URI does not map to a real location, it should raise an exception
that the server can catch to return a 404 response.</li>
</ul>



<div class="slide-no">91</div>


    </article>
  </slide>  <slide class="level-3" id="use-your-tests">
    <hgroup>
      <h3>Use Your Tests</h3>
    </hgroup>
    <article class="">
      <p>One of the benefits of test-driven development is that the tests that are
failing should tell you what code you need to write.</p>
<div class="build docutils container">
<p>As you work your way through the steps outlined above, look at your tests.
Write code that makes them pass.</p>
<p>If all the tests in <code class="docutils literal"><span class="pre">assignments/session02/tests.py</span></code> are passing, you've
completed the assignment.</p>
</div>



<div class="slide-no">92</div>


    </article>
  </slide>  <slide class="level-3" id="submitting-your-homework">
    <hgroup>
      <h3>Submitting Your Homework</h3>
    </hgroup>
    <article class="">
      <p>To submit your homework:</p>
<div class="build docutils container">
<ul class="build simple">
<li>Do your work in the <code class="docutils literal"><span class="pre">assignments/session02</span></code> directory of <strong>your fork</strong> of
the class respository</li>
<li>When you have all tests passing, push your work to <strong>your fork</strong> in github.</li>
<li>Using the github web interface, send me a pull request.</li>
</ul>
<p>I will review your work when I receive your pull requests, make comments on
it there, and then close the pull request.</p>
</div>



<div class="slide-no">93</div>


    </article>
  </slide>  <slide class="level-3" id="a-few-steps-further">
    <hgroup>
      <h3>A Few Steps Further</h3>
    </hgroup>
    <article class="">
      <p>If you are able to finish the above in less than 4-6 hours, consider taking on
one or more of the following challenges:</p>
<ul class="build simple">
<li>Format directory listings as HTML, so you can link to files.</li>
<li>Add a GMT <code class="docutils literal"><span class="pre">Date:</span></code> header in the proper format (RFC-1123) to responses.
<em>hint: see email.utils.formatdate in the python standard library</em></li>
<li>Add a <code class="docutils literal"><span class="pre">Content-Length:</span></code> header for <code class="docutils literal"><span class="pre">OK</span></code> responses that provides a
correct value.</li>
<li>Protect your server against errors by providing, and using, a function that
returns a <code class="docutils literal"><span class="pre">500</span> <span class="pre">Internal</span> <span class="pre">Server</span> <span class="pre">Error</span></code> response.</li>
<li>Instead of returning the python script in <code class="docutils literal"><span class="pre">webroot</span></code> as plain text, execute
the file and return the results as HTML.</li>
</ul>



<div class="slide-no">94</div>


    </article>
  </slide>


    <slide class="thank-you-slide segue nobackground">
    <aside class="gdbar right"><img src="../_static/logo_UW.png"></aside>
    <article class="flexbox vleft auto-fadein">
      <h2>Good Night!</h2>
      <p>&nbsp;</p>
    </article>
    <p class="auto-fadein" data-config-contact>
      <!-- populated from slide_config.json -->
    </p>
  </slide>

  <slide class="backdrop"></slide>

</slides>

<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>